<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stefan Eng">
<meta name="dcterms.date" content="2019-09-01">

<title>Stefan Eng - Inside a Basel Novartis Internship</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Stefan Eng</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/stefaneng" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/stefaneng13/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Inside a Basel Novartis Internship</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">job</div>
                <div class="quarto-category">personal</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Stefan Eng </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 1, 2019</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>This summer I had the privilege of doing a 3 month summer (2019) internship at Novartis’ head office in Basel, Switzerland. I worked in the Scientific Computing and Consulting team within Biostatistics. This post is about the non-technical aspect about the internship at Novartis, particularly focused on Basel. Most of the general information applies to other sites such as Cambridge (USA), East Hanover, or other locations. This post goes into details on</p>
<ul>
<li>Application process</li>
<li>Work visa</li>
<li>Internship requirements</li>
<li>Campus life</li>
<li>Pay and benefits</li>
<li>Novartis provided housing (Some warning about it as well)</li>
</ul>
<section id="tldr-quick-facts" class="level3">
<h3 class="anchored" data-anchor-id="tldr-quick-facts">TL;DR Quick Facts</h3>
<ul>
<li>Averaged about <strong>46 hour weeks</strong> with the max being a <strong>57 hour week</strong></li>
<li>Monthly salary of <strong>2500 francs plus 600 for accommodation</strong> (pre-tax)</li>
<li>5 weeks vacation prorated for the length of your internship (<strong>5.5 days of vacation</strong> for my 3 months)</li>
<li>Flexible working hours and potential to work from home one day a week</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../post/2019-09-01-inside-a-basel-novartis-internship_files/gehry_building.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Building designed by Frank Gehry with restaurants and a large auditorium.</figcaption>
</figure>
</div>
</section>
</section>
<section id="application-process" class="level2">
<h2 class="anchored" data-anchor-id="application-process">Application Process</h2>
<p>I found the job on LinkedIn with the title “Intern - Biostatistics”. The job description must be identical for all jobs in the biostatistics department since my work was nothing like it was described in the posting. I applied through a fairly standard BrassRing website in February and a few days later received an email to set up and interview. The interview was done over Skype. It was a non-technical interview where we went over my job experience. Some of the other questions were standard such as “give me an example of when you dealt with a difficult person at work”. I was interviewed by my future team, two from Cambridge and one from Basel. The job described was completely different than the job posting but I ended up accepting anyway. The whole process from application to offer was fast and professional.</p>
<p>I would say that if you are interested in Pharma and are cold-applying via the website then apply to all positions that are even remotely related to what you are interested in. Even better would be to find contacts within Novartis and find a job directly. Don’t be afraid to apply without pharma experience. I only met one other intern that had worked in pharma before their internship.</p>
</section>
<section id="work-visa" class="level2">
<h2 class="anchored" data-anchor-id="work-visa">Work Visa</h2>
<p>My contract with Novartis was just under 90 days which meant that I did not need an official work permit. Make sure to apply early if you plan to work for over 90 days. EU citizens (particularly western-EU) have a much easier time getting a permit than non-EU countries. One benefit of staying for longer than 90 days is that you are required to register with the Basel Kanton. You then can get apply for a <a href="https://www.sbb.ch/en/travelcards-and-tickets/railpasses/half-fare-travelcard.html">half-price transportation card</a> which makes traveling a bit cheaper.</p>
</section>
<section id="a-global-company" class="level2">
<h2 class="anchored" data-anchor-id="a-global-company">A Global Company</h2>
<p>Novartis truly feels like a global company as many teams are split across the world. Often meeting are done over Skype or similar internal tool for video conferencing. My team in particular had 3 people in Basel and 4 in Cambridge (USA). I also worked with clients in East Hanover (New Jersey). This was both a up and downside for me because it means less face-to-face interaction. I am fairly introverted and wanted to work on my interpersonal skills as much as possible. Even large meetings with 80+ people might only have 8 people in a room on-site. Many people participate in the meetings from their office. I would have liked the presentations that I gave to have had a larger in-person audience. It doesn’t feel like my public speaking skills improved that much from giving presentations over Skype. If you are uncomfortable with public speaking this is probably a plus for you!</p>
<p>An interesting feature of Basel was the language. Since it is so close to both France and Germany there are quite a few people commuting across the border. Meetings here would often start with asking which language to use. The company language was english but there was always accompanying german. My teammate are french and often would have meetings in french. Depends on your team which language you work in.</p>
</section>
<section id="internship-requirements" class="level2">
<h2 class="anchored" data-anchor-id="internship-requirements">Internship Requirements</h2>
<p>There are not a lot of requirements for the Basel Novartis internship. Many interns have to give a end of internship presentation. I believe this was set up automatically in Cambridge and is a requirement. In Basel it seems that your supervisor has to set things up themselves. I ended up giving one bigger presentation and many to clients of my projects. It depends a lot on the field you are in as well.</p>
<p>There is also a two day welcome-day for all new employees which you should make sure to ask your supervisor about. I was unaware of it and was not registered for it. It seemed like a good way for new employees to meet each other and explore the opportunities around campus.</p>
<p>You will have to do some virtual training via the up4Growth internal platform. I had to do general safety training and well as ethics, and proper reporting of data. There are additional in-person trainings you will need to complete if you are working in a lab.</p>
</section>
<section id="hiring-interns" class="level2">
<h2 class="anchored" data-anchor-id="hiring-interns">Hiring Interns</h2>
<p>Novartis has a large number of interns and post-docs. There were many Master’s students I met doing their thesis work at Novartis. The biostatistics department had many PhD students as well. Other interns were post-graduate and had already completed their degree. I did not meet anyone that was doing their Bachelors degree. At least at Basel, the hiring rate for interns seemed pretty low. This is just compared with my experience in the US. Many of the new hires in my department were senior level employees.</p>
<p>Most of the interns at Novartis have longer contracts and are expected to work for at least 3 months. I would say that the majority of the interns that I met were doing 6 month internships. The demands of each group vary dramatically. Some interns had really light work loads on mundane projects and others had high workloads on important projects.</p>
<p>If your goal is to work at Novartis after finishing your internship know that you have to let your team know your goals. If you don’t tell them you want to work for Novartis you will never get hired. For me this was not an issue as I was not looking for a full-time job from Novartis after my internship.</p>
</section>
<section id="campus-life" class="level2">
<h2 class="anchored" data-anchor-id="campus-life">Campus Life</h2>
<p>Life at Novartis campus is pretty awesome. They have a <a href="https://campus.novartis.com/">virtual tour available</a> and if you are in Basel you can get an art tour of the campus. The architecture of the new buildings is really beautiful. There is a building designed by Frank Gehry. An overview of the other architecture can be <a href="https://www.e-architect.co.uk/switzerland/novartis-basel-headquarters">found here</a>. One of my favorite buildings was Asklepios, a new building overlooking the Rhine. The view from inside the building is fantastic. You can even take a swim in the Rhine during lunch.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../post/2019-09-01-inside-a-basel-novartis-internship_files/asklepios_view.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">The view from Asklepios of the Rhine</figcaption>
</figure>
</div>
<p>The campus is like a small city. You have a coop supermarket, many restaurants, coffee places (even starbucks), ice cream vendors, apple trees, koi pond, and lounge chairs. There is lots of trees and grass to have an enjoyable lunch. Coffee, tea and water are provided in the building. The free coffee is mediocre (the kaffee créme beans are better than the espresso roast) but you can always have a better cup of coffee at one of the cafés around campus.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../post/2019-09-01-inside-a-basel-novartis-internship_files/novartis_outside_areas.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Nice areas on campus to take a break</figcaption>
</figure>
</div>
<p>There are always interesting talks and presentations going on around campus. Biostatistics in particularly always seemed to have technical presentations going on. There is lots of effort put into professional development via presentations and courses. I attended a “biostatistics boot camp” which was one of my favorite parts of the summer. I highly recommend it to anyone interested in how drugs progress in human trials, from Phase 1 to market and beyond.</p>
</section>
<section id="pay-and-benefits" class="level2">
<h2 class="anchored" data-anchor-id="pay-and-benefits">Pay and benefits</h2>
<p>The base salary for a Master’s student is 2500 francs per month. There is also a living stipend of 600 francs per month. They provide one-way transportation fees up to 400 francs. Your salary is paid into a Novartis bank account where you can transfer money to EU banks. Interns receive vacation prorated for the amount of time they are staying based on the 5-week full time employee yearly vacation. For me this meant I had 5.5 days vacation. Depending on your contract you probably need to clock in your hours. This is done with your badge when you come into your building or go out for lunch. If you miss a clock-in there is an ancient web interface to do it on as well.</p>
<p>Novartis has flexible working hours, which means that you are supposed to have within 25 hours of the monthly full time hours (40 hours per week). This means that if you work more than 8 hours in a day you accrue flextime, up to 25 hours. If you need to leave for a half-day you can take your flextime without any issue. I ended up accumulating lots of hours of flextime and was able to take three full days off in the middle of my internship to get a full week off due to a Thursday/Friday holiday for the Swiss National Day. I ended my internship with a huge surplus of flextime which I was told will be paid out. I did not end up taking my 5.5 days of vacation which will be paid out as well.</p>
<p>In general most people that I worked with were extremely busy and worked many hours. The older, more established employees seemed to take vacation regularly and it was common to have auto-reply emails for all of August. My building was a ghost town in August. Your work-life balance depends a lot on the group you are in. On average I worked about 46 hour weeks with the max being 57. I worked about two half days on the weekend but this was my choice to be better prepared for the week.</p>
<p>You are also allowed to work 20 percent from home (one full day a week). I didn’t really take advantage of this since I wanted to interact with as many people as I could.</p>
</section>
<section id="accomodations" class="level2">
<h2 class="anchored" data-anchor-id="accomodations">Accomodations</h2>
<p>Novartis provides an options for housing through Aprentas housing. I stayed at the Eglisee Wohnheim Aprentas house which cost 700 francs per month for a “small” room. There are also larger rooms for 800 available. It is about 20–30 minutes by tram and about 35 minutes to walk. Biking is really fast if you have one. I ended up walking most days when it was not raining.</p>
<p>It was nice that I was able to move to Basel without having to worry about find a place to live. The house had capacity for 30 people, 15 guys and 15 girls. Almost everyone was an intern for Novartis which makes it easy to meet people. There was a shared kitchen and everyone had cleaning duty for a week at a time. Overall everyone was really nice and the staff took good care of the place. There was a large proportion of Italians in the house that seemed to always be cooking some amazing smelling food.</p>
<section id="warning-move-in-on-the-first-or-the-sixteenth-of-the-month" class="level3">
<h3 class="anchored" data-anchor-id="warning-move-in-on-the-first-or-the-sixteenth-of-the-month">Warning: Move in on the first or the sixteenth of the month</h3>
<p>One gotcha with this was the first months rent (and potentially the last months as well). The housing provided charged full price if you moved in the first 15 days of the month and half price any of the second half days. Okay, seems reasonable. Novartis pro-rates the reimbursement amount based on exactly the number of days you worked this month. So if you move in on the first or 16, no problem. So if you move in the 15th, you will receive ~300 from Novartis but pay the full 700 amount. Similarly if you move in right before the end of the month you will be charged 300 and only receive a small stipend. I told Novartis HR about this but no policy change has occurred so make sure to confirm with them if you get an internship.</p>
</section>
<section id="warning-aprentas-housing-in-muttenz" class="level3">
<h3 class="anchored" data-anchor-id="warning-aprentas-housing-in-muttenz">Warning: Aprentas housing in Muttenz</h3>
<p>There is a larger Aprentas housing in Muttenz. It is almost 45 minutes away from Novartis by tram and you are far out of the city center. For most people this housing option is probably worse. The benefits are it is really close to a bouldering gym, <a href="https://www.bzwei.ch">B2 Boulders and Bar</a> as well as closer to the alps and popular tourist cities (Interlaken, Grindelwald, Bern, etc.)</p>
</section>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing Thoughts</h2>
<p>Overall I had an extremely positive internship experience with Novartis. I would highly recommend anyone interested in pharma to apply. It is a fast-paced environment that will challenge you and make you grow. I made so many good connections this summer and will definitely consider working their after I do my PhD. Feel free to reach out for any questions.</p>
<p>If you enjoyed this then stay tuned for my follow up on life in Basel, and the technical portions of my internship.</p>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources</h2>
<ul>
<li><a href="https://www.novartis.com/">Novartis Website</a></li>
<li><a href="https://www.linkedin.com/company/novartis">Novartis LinkedIn</a></li>
<li><a href="https://github.com/Novartis">Novartis Open Source</a></li>
<li><a href="https://www.aprentas.com">Aprentas Housing</a></li>
<li><a href="http://www.lifeinbasel.com/">Life in Basel</a></li>
<li><a href="https://www.swissinfo.ch/eng/work-permits/29191706">Work permits in Switzerland</a></li>
<li><a href="https://www.quora.com/How-can-I-win-an-internship-at-Roche-or-Novartis-in-Basel">Quora: How can I win an internship at Roche or Novartis in Basel?</a></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>