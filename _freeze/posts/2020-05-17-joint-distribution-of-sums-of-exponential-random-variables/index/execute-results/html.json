{
  "hash": "080d6ddbf645d8e0ef831963e305dee6",
  "result": {
    "markdown": "---\ntitle: Joint distribution of sums of exponential random variables\nauthor: Stefan Eng\ndate: '2020-05-17'\nslug: joint-distribution-of-sums-of-exponential-random-variables\ncategories:\n  - math\ntags:\n  - probability\n  - exercise\noutput:\n  blogdown::html_page:\n    toc: no\n    fig_width: 5\n    fig_height: 5\nlink-citations: true    \ncsl: ../../static/bibtex/acm-sig-proceedings.csl\nbibliography: ../../static/bibtex/probability.bib\n---\n\n::: {.cell}\n\n:::\n\n\nThis is a problem from Ross's Stochastic Processes [@ross1996stochastic].\nLet \n$$\n\\begin{aligned}\nS_1 &= X_1\\\\\nS_2 &= X_1 + X_2\\\\\nS_3 &= X_1 + X_2 + X_3\n\\end{aligned}\n$$\nwhere $X_1, X_2, X_3$ are i.i.d exponential random variables with rate $\\lambda$.\nFind the joint distribution of $S_1, S_2, S_3$.\n\nLet $f$ be the PDF of each $X_1, X_2, X_3$ (since identically distributed). Since $X_1, X_2, X_3$ are independent the joint PDF is \n$$\nf(x,y,z) = f(x) f(y) f(z) = \\lambda^3 e^{-\\lambda x} e^{-\\lambda y} e^{-\\lambda z}\n$$\nThen we can find the joint CDF of $S_1, S_2, S_3$\n$$\n\\begin{aligned}\nP(S_1 \\leq t_1, S_2 \\leq t_2, S_3 \\leq t_3) &= \\int_{0}^{t_1} \\int_{0}^{t_2 - x} \\int_{0}^{t_3 - x - y} f(x,y,z) ~dz~dy~dx\\\\\n&= \\int_{0}^{t_1} \\int_{0}^{t_2 - x} \\int_{0}^{t_3 - x - y} \\lambda e^{-\\lambda z} \\lambda e^{-\\lambda y} \\lambda e^{-\\lambda x}~dz~dy~dx\\\\\n&= \\int_{0}^{t_1} \\lambda e^{-\\lambda x} \\int_{0}^{t_2 - x} (1 - e^{-\\lambda (t_3 - x - y)}) \\lambda e^{-\\lambda y}~dy~dx\\\\\n&= \\int_{0}^{t_1} \\lambda e^{-\\lambda x} \\left[\\int_{0}^{t_2 - x} \\lambda e^{-\\lambda y}~dy -  \\int_{0}^{t_2 - x} e^{-\\lambda (t_3 - x)}~dy\\right]~dx\\\\\n&= \\int_{0}^{t_1} \\lambda e^{-\\lambda x} \\left[(1 - e^{-\\lambda (t_2 - x)}) - (t_2 - x) e^{-\\lambda (t_3 - x)}\\right]~dx\\\\\n&= \\int_{0}^{t_1} \\lambda e^{-\\lambda x} ~dx - \\int_{0}^{t_1} \\lambda e^{-\\lambda t_2} ~dx - \\int_{0}^{t_1} (t_2 - x) e^{-\\lambda t_3}~dx\\\\\n&= 1 - e^{-\\lambda t_1} - \\lambda t_1 e^{-\\lambda t_2} - t_1 t_2 e^{-\\lambda t_3} + \\frac{1}{2} t_1^2 e^{-\\lambda t_3}\n\\end{aligned}\n$$\n\n### Simulation\nWe can confirm these results with a simple simulation in R.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Computed joint CDF\nexpect_joint <- function(t1, t2, t3, lambda = 1) {\n  1 - exp(- lambda * t1) - lambda * t1 * exp(-lambda * t2) - \n    t1 * t2 * exp(-lambda * t3) + 1/2 * t1^2 *exp(- lambda * t3)\n}\n\n# Simulate 1000 realizations of S1, S2, S3\nsim <- function(t1, t2, t3, rate = 1, n = 1000) {\n  s1 <- rexp(n, rate)\n  s2 <- s1 + rexp(n, rate)\n  s3 <- s2 + rexp(n, rate)\n  \n  mean(s1 <= t1 & s2 <= t2 & s3 <= t3)\n}\n\n# P(S1 <= 1, S2 <= 2, S3 <= 3) with lambda = 1\nt1 <- 1\nt2 <- 2\nt3 <- 3\nrate <- 1\n# Replicate the simulation 1000 times\nsim_res <- replicate(1000, sim(t1, t2, t3, rate))\n\ncat(\"Simulated mean:\", round(mean(sim_res), 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimulated mean: 0.422\n```\n:::\n\n```{.r .cell-code}\ncat(\"Expected joint distribution:\", round(expect_joint(t1, t2, t3, rate), 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nExpected joint distribution: 0.422\n```\n:::\n:::\n\n```\n\n### References\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}